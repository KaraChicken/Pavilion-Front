import{_ as C,a0 as F,D as P,E as B,r as D,o as A,G as c,H as E,J as M,c as t,L as s,N as R,S as T,Q as l,R as m,P as i,$}from"./index-79391d2e.js";import{c as k,e as H,u as N,b as j,V as I}from"./VForm-ed04b970.js";import{S as p}from"./sweetalert2.all-04b561c2.js";import{V as L}from"./VOverlay-11237b9a.js";import{a as U,V as G}from"./VRow-73548b48.js";import{V as J}from"./index-56466a3f.js";import{V as O}from"./VTextField-f19559fa.js";import{V as y}from"./VBtn-fad528cb.js";import"./scopeId-3681e770.js";/* empty css              */import"./tag-9dd3b1e3.js";import"./index-0f2a5105.js";const Q={__name:"ProductView",setup(z){const V=F(),_=P(),{api:h,apiAuth:x}=T(),f=B(),a=D({_id:"",name:"",price:0,description:"",image:"",sell:!0,category:""}),v=k({quantity:H().typeError("缺少數量").required("缺少數量").min(1,"數量最小為 1")}),{isSubmitting:g,handleSubmit:b}=N({validationSchema:v,initialValues:{quantity:1}}),d=j("quantity",v),w=b(async n=>{var o,e;if(!f.isLogin){_.push("/login");return}try{const{data:r}=await x.patch("/users/cart",{product:a.value._id,quantity:n.quantity});f.cart=r.result,p.fire({icon:"success",title:"新增成功",timer:800})}catch(r){const u=((e=(o=r==null?void 0:r.response)==null?void 0:o.data)==null?void 0:e.message)||"發生錯誤，請稍後再試";p.fire({icon:"error",title:u,confirmButtonText:"確定"})}});return A(async()=>{var n,o;try{const{data:e}=await h.get("/products/"+V.params.id);a.value._id=e.result._id,a.value.name=e.result.name,a.value.price=e.result.price,a.value.description=e.result.description,a.value.image=e.result.image,a.value.sell=e.result.sell,a.value.category=e.result.category,document.title=`購物網 | ${a.value.name}`}catch(e){const r=((o=(n=e==null?void 0:e.response)==null?void 0:n.data)==null?void 0:o.message)||"發生錯誤，請稍後再試";p.fire({icon:"error",title:r,confirmButtonText:"確定"}),_.push("/")}}),(n,o)=>{const e=c("H1"),r=c("P"),u=c("Div"),S=c("VCantainer");return E(),M(R,null,[t(S,null,{default:s(()=>[t(U,{style:{height:"100%"}},{default:s(()=>[t(G,{class:"d-flex justify-center align-center",cols:"12"},{default:s(()=>[t(u,{class:"pa-5 overflow",style:{width:"75rem",height:"43.75rem","border-radius":"20px","background-color":"#CAAD5F"}},{default:s(()=>[t(e,{class:"text-center mb-10",style:{color:"#261E47"}},{default:s(()=>[l(m(a.value.name),1)]),_:1}),t(u,{class:"content"},{default:s(()=>[t(J,{src:a.value.image},null,8,["src"]),t(r,null,{default:s(()=>[l("單價： "+m(a.value.price),1)]),_:1}),t(r,{style:{"width-space":"pre"}},{default:s(()=>[l("商品說明："+m(a.value.description),1)]),_:1}),t(I,{disabled:i(g),onSubmit:$(i(w),["prevent"])},{default:s(()=>[t(O,{type:"number",min:"0",modelValue:i(d).value.value,"onUpdate:modelValue":o[0]||(o[0]=q=>i(d).value.value=q),modelModifiers:{number:!0},"error-messages":i(d).errorMessage.value},null,8,["modelValue","error-messages"]),t(y,{type:"submit","prepend-icon":"mdi-cart",loading:i(g)},{default:s(()=>[l("加入購物車")]),_:1},8,["loading"])]),_:1},8,["disabled","onSubmit"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(L,{class:"align-center justify-center text-center","model-value":!a.value.sell},{default:s(()=>[t(e,{class:"text-red text-h1"},{default:s(()=>[l("已下架")]),_:1}),t(y,{to:"/",color:"green"},{default:s(()=>[l("回首頁")]),_:1})]),_:1},8,["model-value"])],64)}}},ie=C(Q,[["__scopeId","data-v-c59dac9d"]]);export{ie as default};
